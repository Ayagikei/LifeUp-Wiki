# 后台保活

## 为什么需要设置允许后台运行？

部分手机厂商为了省电或性能指标，会对除白名单（如 QQ、微信、支付宝）外的大多数应用实施严格后台限制，导致部分依赖后台的功能无法正常执行（例如切到后台后番茄钟被系统终止）。

**这类限制会显著增加开发者的适配成本，也会提高用户的配置成本。**

一般会导致出现以下现象：

- 切换到其他应用或锁屏后，**番茄钟、倒计时结束后不提醒或被暂停了**（前者是系统冻结了应用执行；后者是系统直接杀死了应用进程）。
- 后台接收不到事项的通知提醒。
- 桌面小部件不会自动刷新，或者有任务却显示「已经完成全部任务」。

<br/>

**这些设置是否会影响耗电量？**

理论上会有些许影响，但《人升》后台只会执行必要的逻辑。

根据[开发工效](introduction/ergonomics.md)中的数据，后台运行 24 小时的耗电量约为 30 mAh，占比不到 1%。

<br/>

## 如何设置后台运行

### 通用设置

> 以下步骤不一定要全部执行，但每完成一步，都可能提升《人升》后台运行优先级，帮助相关功能更稳定。

**Android 系统**

1. 进入《人升》，点击侧边栏-「设置」-「兼容性问题」，点击「跳转电池优化设置」，在该页面找到《人升》并设置「不优化」。
   - 部分手机可能会跳转后找不到《人升》，可忽略该配置。

2. 如果你希望收到通知，请确保授予《人升》通知权限。

3. 在《人升》的「设置」-「事项」中，开启「快速创建常驻通知」（可选）。

<br/>

**厂商自定义（手机管家）**

1. 在系统的多任务管理界面，锁定应用。
2. 在系统中查找应用后台管理（或电源优化、手机管家），将《人升》设置为「允许后台运行（后台不限制）」和「允许自启动」。
3. 使用《人升》相关功能期间，**尽量避免开启超级省电、严格免打扰等模式**，或将《人升》加入白名单。

<br/>

### 各个设备设置方式

**或者直接参考飞书整理的各种设备的设置方式：**

> 因为我们实在缺少相关手机和测试验证的时间，直接外链下飞书的设置文档。
> 飞书也不在大多数厂商的后台白名单中，同样需要手动设置后台权限才能稳定接收通知。

[安卓设备收不到新消息通知怎么办？ (feishu.cn)](https://www.feishu.cn/hc/zh-CN/articles/360025451293)

1. [华为手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-RNpJyL)

2. [OPPO 手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-rqfhmK)

3. [Vivo 手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-xi6S8F)

4. [小米手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-uoxEk6)

5. [锤子手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-ylGl04)

6. [魅族手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-5zC9BG)

7. [三星手机](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-e1tk3a)

除了文中提到的配置外，各厂商系统也可能持续增加新的省电策略。

开启这类策略后，也可能影响《人升》相关功能的正常使用。



**设置后仍不生效？**

根据我们针对各个厂商的实测和用户的反馈：

**在正确配置上述选项后，《人升》能在所有主流设备上正常使用所有功能。**

但由于手机系统持续更新，相关配置项可能会随版本变化而调整。

1. **请重新按照上述步骤查漏补缺**
   - 手机管家类的限制并非传统的应用权限，可能配置项会分散在不同的系统设置页面里。
   - 尝试操作那些可选的步骤，比如开启《人升》的常驻通知，查看是否会有所帮助。
   - 手动在手机查找可能会影响电池优化的选项。
   - 如果你只关注提醒，可以尝试切换至「日历提醒」方式。

2. 在 QQ 群或 QQ 频道咨询使用同品牌设备的用户，并清晰说明你的系统版本。

3. 也可以咨询手机厂商客服或系统工程师，确认如何让指定应用保持后台运行。

---



以下是我们基于有限设备整理的操作方式，可能随系统更新而变化：

### 华为/荣耀

1. 打开「设置」。
2. 搜索「应用启动管理」并点击。
3. 找到《人升》，设置为手动管理并允许自启动。



**操作截图如下：**

![](_media/background_running/emui_01.jpg ':size=50%')

![](_media/background_running/emui_02.jpg ':size=50%')

![](_media/background_running/emui_03.jpg ':size=50%')


### 魅族

1. 打开「手机管家」应用。
2. 点击「权限管理」。
3. 点击「后台管理」。
4. 找到《人升》，选择「允许后台运行」。
5. （可选）多任务界面中，长按锁定《人升》。



**操作截图如下：**


![](_media/background_running/flyme_01.jpg ':size=50%')

![](_media/background_running/flyme_02.jpg ':size=50%')

![](_media/background_running/flyme_03.jpg ':size=50%')
