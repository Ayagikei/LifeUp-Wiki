# 1.87.0 - 列表最佳化

## 🔖總覽

該版本因為跨了個年，將較多時間放在瞭解決和處理一些疑難雜症和效能最佳化上。

本次針對列表的滑動效能、成就子分類列表支援摺疊、倉庫排序規則等做了一系列最佳化工作。

近期也會繼續在開發一些呼聲較高的小新特性之外，也會將精力放在一系列效能最佳化和問題解決上。

1. **列表最佳化（子分類摺疊、倉庫排序、滑動效能）**
2. **Material You設計風格**
3. **任務凍結時長**
4. **備註自動新增商品獎勵資訊**
5. **比較小但實用的改進項**
7. **完整更新日誌**

<!-- more -->

---

## ✨ **列表最佳化（子分類摺疊、倉庫排序、滑動效能）**

### 1. 子分類摺疊

![](_media/186/01.png ':size=30%')

> 上個版本的介紹圖片其實已經劇透了該功能。

<br/>

**📝 使用方式**

直接點選子分類即可「摺疊」或者「取消折疊」該分類的內容。

<br/>

**小技巧：**

如果想要一次性拖動多個成就排序，可以先用子分類摺疊起來所有內容，然後拖動子分類到相應位置即可。

<br/>

### 2. 倉庫排序

![](_media/187/01.png ':size=30%')

爲了使倉庫商品的排序更可控，該版本增加了`跟隨商店排序`和`星標`兩種操作。
`星標`可以使倉庫物品置頂。

<br/>

**📝 使用方式**

【跟隨商店排序】

在商店/倉庫頁面，點選右上角選單，選擇「倉庫排序」即可設定為`跟隨商店排序`。



【星標】

![](_media/187/02.png ':size=30%')

長按選擇商品後，即可在選單中對商品進行`星標`操作。


### 3. 滑動效能

在以往版本中，委託頁面快速滑動時，其實會出現較嚴重的卡頓現象。

作為工具類 APP，穩定性和效能其實都是很重要的一環。

<br/>

經常問題排查，一張預設卡片的繫結資料時長可能長達 5-15 毫秒。如果任務備註過長，甚至可能達到 40 毫秒。

> 小知識：一幀渲染超過 16 毫秒即可感受到掉幀。

<br/>

經過了一系列的原因排查和最佳化手段，我們成功將**一張卡片繫結資料的時長從 5-15 毫秒減少到了 0-1 毫秒**。

這意味著在新版本中，快速滑動基本不會出現卡頓現象。簡潔模式卡片由於UI要素更簡單，效能也更佳。

<br/>

###  🚧 後續發展

**在即將到來的下個內測版本中，我們【已經】完成了下述最佳化開發：**

1. 最佳化“全部”清單的排序處理，防止各個清單的自定義排序會互相影響導致排序錯亂。
2. 最佳化商品、任務選擇彈窗的渲染邏輯，當前版本如果現存上百個商品，會明顯示卡頓長達幾秒。

<br/>

**更未來版本的計劃：**

1. 在任務、商品的智慧清單中也實現摺疊互動邏輯。
2. 最佳化各個列表的渲染速度。



---

## ✨ Material You設計風格

![](_media/187/03.png ':size=30%')

Material You (亦稱Material Design 3) 是谷歌最新推出的設計語言，主要在 Android 12 上實現了動態主題色功能。

未來官方針對 UI 控制元件的特性更新也會主要體現在 Material You 上。

目前`人升`已經部分適配了 Material You，可以一鍵自由切換，體驗新版本的 UI。

<br/>

### 📝 使用方式

![](_media/187/04.png ':size=30%')

點選側邊欄-`實驗`-`Material You設計語言`，點選開啟即可。

<br/>

### 🚧 後續發展

4. 【下個版本】會適配彈窗圓角和背景風格。
4. 【未來版本】會持續跟進谷歌官方的更新。



---

## ✨ 任務凍結時長

![](_media/187/05.png ':size=30%')

該版本【會員】支援指定任務的凍結時長。

到達時間節點後，任務將會自動解凍，不用再擔心忘記解凍了。

<br/>

適用於**已知一段時間**內不需要做某些任務的場景，比如10天不需要做某個任務，可以指定凍結10天。

<br/>

### 📝 使用方式

![](_media/187/06.png ':size=30%')

長按單個或多個任務卡片，在右上角選單選擇`凍結`-`直到...`然後選中相應的日期即可。





---

## ✨ 備註自動新增商品獎勵資訊

![](_media/187/07.png ':size=30%')

更多使用者在使用任務的時候，習慣性在任務備註中新增獎勵資訊（因為目前的卡片不會直接展現商品獎勵名稱，也缺少足夠的空間）。

新版本針對【會員】增加了一個小的特性，支援自動在任務備註顯示時新增`“獎勵：【商品】”`資訊。

<br/>

### 📝 使用方式

**該功能僅適用於非簡潔模式**。

點選`側邊欄`-`設定`-`進階`然後開啟下述設定即可：

![](_media/187/08.png ':size=30%')





---



## ✨ 比較小但有用的改進

- 商品購買、使用、退貨等操作支援直接MAX數量
- 商店支援`全選`操作
- 任務支援`繼續建立下一個`
- 獲取商品獎勵時，如果商品數量曾經為負數，增加相應的警告顯示
- 商品售罄不再自動下架
- 擴充套件頁面UI重新設計

<br/>

## ✨ 完整更新日誌

**1.87.1（2022/3/07）**

1. 商店和倉庫的排序選單顯性顯示“自定義”排序
2. 修復倉庫中可能出現異常排序的問題
3. 反饋頁面新增跳轉郵件反饋的按鈕
4. 最佳化因資料庫版本問題恢復失敗的提示語
5. 修復簡潔模式卡片偶現金幣數量不展示的問題

**1.87.0正式版（2022/3/04）**

> 這裏僅包含內測結束的修復改動，更多特性改動請檢視內測版本日誌

1. 修復自定義卡片背景某些情況下會縮放異常的問題
2. 修復在連續收到任務提醒時，點選任務提醒通知可能會跳往錯誤任務詳情的問題
3. 修復滑動增加計數任務計數時，卡片上的數字不正常重新整理的問題
4. 增加新版本新手指引任務

**1.87.0-rc02（2022/2/25）**

1. 完善恢復操作的錯誤處理和提示
2. 最佳化設定“每週幾”的互動，增加設定異常（開始-期限不處於同一天）的警告
3. 最佳化部分頁面的夜間模式配色
4. 修復圖片選擇框和圖片管理內可能會錯誤顯示快取的問題
5. 修復備份衝突彈窗中的“下載”操作不支援Google Drive/Dropbox的問題
6. 修復商店的搜尋可能會顯示錯誤結果的問題
7. 修復任務置頂可能會失效的問題
8. 修復部分UI異常和文字問題

**1.87.0-rc01（2022/2/23）**

**✨特性**

1. 成就子分類支援摺疊操作
2. 引入Material You設計風格開關（實驗）
3. 倉庫支援跟隨商店排序
4. 倉庫支援商品“星標”操作
5. 商店支援全選操作
6. 商店、倉庫的相關操作支援選擇MAX數量
7. 任務支援連續建立
8. 任務支援配置：卡片備註自動新增商品獎勵的描述（即會自動顯示“獎勵：【某商品】x1”）（會員）
9. 任務支援指定凍結持續時長（會員）

**⚡️最佳化**

1. 備份衝突彈窗增加“跳過”按鈕
2. Play版本支援法語/波蘭語
3. 任務點選通知提醒現支援跳轉到任務詳情
4. 編輯任務相關時間時，預設彈窗會指向編輯前的時間而非當前時間
5. 商店的各個清單選擇入口都支援“重新命名”、“刪除”、“新建”操作
6. 擴充套件頁面UI重新設計
7. “刪除日曆賬號”增加二次確認彈窗
8. 商品售罄不再自動下架
9. 示例任務中的“早起”任務改為0懲罰
10. 獲得商品獎勵時，如果商品數量為負數，現在會出現相關警告
11. 最佳化商品使用效果中的金幣隨機演算法
12. “設為完成”操作增加完成音效
13. 最佳化夜間模式下的部分UI顯示
14. 最佳化任務列表的效能表現

**🐛修復**

1. 修復部分語言下，“未關注”的文案異常
2. 修復“退貨”彈窗上的商品圖示可能顯示不正常的問題
3. 修復任務可能在快速完成時重複生成的問題
4. 修復“合成”系統的當前清單的記憶可能失效的問題
5. 修復橫屏狀態下可能無法正常QQ登入的問題
6. 修復“合成”系統在[全部]清單編輯合成配方，可能會導致合成配方在原清單中消失的問題
7. 修復無限任務連續多次點選完成，可能會導致完成次數顯示歸零的問題
8. 修復備份無法設定“每月”備份間隔的問題
9. 修復簡潔模式下經驗圖示不顯示的問題
10. 修復圖片管理中缺少“成就”、“成就清單”欄目的問題
11. 修復任務詳情頁面不支援放棄團隊任務的問題
12. 修復世界模組的指引未正確展示的問題
13. 修復圖片上傳失敗時，也能夠成功分享商品，但本地圖片會被覆蓋的問題
14. 修復部分罕見崩潰和異常問題