<h1 align="center" padding="100">v1.90.0 - 開放介面更新介紹</h1>

<p align="center">創造無限可能性！</p>

> 歡迎在公眾號檢視本文，並可訂閱未來的更新~
>
> [v1.90.0 - 開放介面更新介紹 (qq.com)](https://mp.weixin.qq.com/s?__biz=MzI0OTQ4OTAxMQ==&mid=2247483985&idx=1&sn=5a4d2854b8c175d39193e1d55bc5c0e0&chksm=e991f14ddee6785b80954d72e638e72c37fcd3774b2ba230bded011c8d37f34b622280e5f622&token=1232886144&lang=zh_CN#rd)





「人升」的版本號終於來到了 1.90，**本次更新會帶來不太一般的特性更新：引進了「開放介面（API）」這個硬核功能。**我們希望藉此功能為「人升」帶來無限的可能性。

> 本文僅介紹「開放介面」這一特性，其他更新介紹會留到下一期。



## 🔖場景介紹

![](_media/190/09.png ':size=30%')


**這是個什麼樣的功能？**

簡言之，就是「人升」：
1. 提供了“使用商品”作為觸發點，支援跳轉網頁、其他應用或者呼叫自己的 API 介面
2. 開放大量的高自由度 API，比如獎勵並定製化理由、自動建立任務、錄入計時記錄。




**這麼說可能還是比較難以理解，下面舉一些場景例子：**

1. **跳轉網頁：**使用商品，然後開啟百度。
2. **跳轉應用：**使用商品，然後開啟QQ、網易雲。
3. **跳轉應用內部頁面：**使用商品，然後開啟跳轉人升官方QQ群、支付寶-螞蟻森林、B站-搜尋人升。
4. **呼叫外部應用 API：**使用商品後，自動記賬（錢跡）；或者也支援使用佔位符實現輸入金額記賬。
5. **呼叫“人升” API：**使用商品後，提升 ATM 利率 0.01%。
6. **呼叫“人升” API：**使用一個叫做“降價券”的商品，然後選擇某個商品使其降價 2 金幣。
7. **呼叫“人升” API：**使用 API 建立好任務模板。使用商品時，輸入任務名和選擇清單就可以建立出帶有獎勵模板的任務。
8. **網頁呼叫“人升”API：**在瀏覽器完成一場Wordle，猜中單詞後，人升中獎勵 10 金幣。並且有定製的獎勵理由。
9. **自動化工具/外部應用呼叫“人升” API：**每天起床解鎖手機，自動完成「起床」任務。晚起時，自動觸發晚起懲罰。
10. **自動化工具/外部應用呼叫“人升” API：**截獲運動 App 的鍛鍊通知，自動新增「力量」經驗值。
11. **自動化工具/外部應用呼叫“人升” API：**在自己設定的學習時間段，每開啟一次手機觸發一次懲罰。

<!-- more -->

---

## 📝 **使用建議**

![](_media/190/03.png ':size=30%')

舉的🌰有點多。
但透過這些例子，應該能對這個功能稍有了解。

**但也請不要擔心這個功能難以使用：**
- 如果你不熟悉網路或計算機基礎知識，你可以直接在櫥窗搜尋、進貨相關的商品；也可以嘗試根據示例或者其他人的商品，編輯引數。**目前在「櫥窗」-「連結」（以及「API」、「自動化」）標籤已經有上架一批特殊商品。**

- 如果你熟悉相關基礎知識，可以嘗試閱讀下述的介面文件，自己編輯出所需的效果。並且搭配自動化軟體（如 Tasker）使用，即便不會編輯 Tasker 的配置，只要你能成功安裝 Tasker，也能在櫥窗或者其他社羣匯入其他人分享的自動化配置。

- 如果你熟練掌握開發，可以嘗試開發網頁、安卓應用與人升聯動。這個網頁就是個超簡單的例子。或者編寫自動化工具的配置，分享給大家！



## 💡典型場景

![](_media/190/01.jpg ':size=30%')

你可以在我們的文件庫裡找到介面文件。在點選商品連結效果時，也會有介面文件超鏈接（https://wiki.lifeupapp.fun/zh-hant/#/guide/api）。

文件中會向你介紹關於 URL 的基本知識，每個 API 的定義、用法和示例。



接下來，我們會從一些場景拋磚引玉，介紹一些典型場景：

### ✨開啟網頁或其他應用

![](_media/190/04.png ':size=30%')

如果想要開啟網頁，你只需要輸入對應的網址（URL）即可。比如`https://www.baidu.com`.

如果想要開啟其他應用或應用內頁面，則需要得知它們的專屬 URL Scheme。
除了技術手段外，你可以透過百度搜索（比如QQ+URL Scheme）的方式得知。

比如開啟 QQ 的連結是`mqq://`，開啟 B 站是`bilibili://home`

### ✨激勵語

![](_media/190/05.png ':size=30%')

「人升」提供了彈出訊息的 API。這可以用作使用商品時的激勵語。

關於 URL 的具體拼接規則，可以檢視介面文件裡的介紹。此處為截圖：



**示例：**`lifeup://api/toast?text=好好生活，好好吃飯！&type=1&isLong=true`
**解釋：**以獎勵樣式彈出提示“好好生活，好好吃飯！”，並且顯示較長時間。






### ✨獎勵

該版本還提供了獎勵或懲罰經驗值、金幣和商品的功能。並且你可以定製獎勵或懲罰功能。

**示例：**`lifeup://api/reward?type=coin&content=學習API呼叫&number=1`
**解釋：**獲得 1 點金幣，獲得原因為「學習API呼叫」，且原因會在金幣詳情頁面展示。

因為商品本身就可以設定金幣、經驗值獎勵，你可能會覺得該功能有些冗餘。

但實際上該 API 主要是用於外部應用聯動使用的。

#### Wordle 聯動

![](_media/190/wordle.png ':size=30%')

Wordle 是一款猜單詞的網頁益智遊戲。

該版本簡單修改了程式碼，接入了上述的獎勵介面，實現了與人升聯動：猜對單詞即可獲得「人升」金幣獎勵，猜錯了可能也有安慰獎？

**升級到 v1.90 版本後，你可以在櫥窗搜尋“猜單詞”找到該網頁聯動示例進行體驗。**



### ✨提升 ATM 利率

![](_media/190/02.png ':size=30%')

使用商品提升 ATM 利率則是一個典型的示例：在之前版本的「人升」中，這隻能透過手動實現。

該版本加入了商店設定的 API，你可以透過 API 實現該功能。而我們也不需要因此開發複雜的互動功能。

**示例：**`lifeup://api/shop_settings?key=atm_interest&value=0.01&set_type=relative`
**解釋：**每次使用該商品，將 ATM 日利率提升0.01%




### ✨降低某個商品價格

![](_media/190/06.png ':size=30%')

上述的例子基本都是通用設定。

如果想要針對某個商品、某個任務進行設定要怎麼做？

#### 獲取 id 或用名稱模糊匹配

一般此類編輯介面都會提供 id 或者 name 模糊匹配的搜尋方式。

比如降低商品價格：

**透過商品 id 搜尋**
**示例：**`lifeup://api/item?id=1&set_price=-1&set_price_type=relative`
**解釋：**對 id 為 1 的商品，將其價格降低 1 金幣

**透過商品名稱模糊匹配**
**示例：**`lifeup://api/item?name=休息&set_price=-1&set_price_type=relative`
**解釋：**對名字包含“休息”的其中一件商品，將其價格降低 1 金幣

如果你想要獲取 id 的話，可以在[設定]-[實驗]頁面，開啟[開發者模式]。

開啟後，你可以在對應的詳情頁面看到資料的原始id。

#### 佔位符

![](_media/190/10.jpg ':size=30%')

還有一種方式是使用佔位符。

在使用者使用商品的時候，由使用者選擇具體的商品。

這就可以使用「永久打折券」效果。

使用方式也很簡單，直接將上述示例中的具體 id 替換為 [$item] 即可。

示例：`lifeup://api/item?id=[$item]&set_price=-1&set_price_type=relative`

針對佔位符的更多細節，你可以檢視 API 文件。



**除了針對商品價格的調整外，我們在 v1.90 - rc02 版本還提供了開箱的聯動。你還能實現動態調整箱子內物品的獲取機率、數量和新增物品等。**




### ✨呼叫錢跡自動記賬

![](_media/190/07.png ':size=30%')

「錢跡」是一款優秀的獨立開發記賬軟體，它也提供了對應的記賬 API。因此「人升」也能透過介面呼叫。

**示例：**`qianji://publicapi/addbill?&type=0&money=26.5&catename=咖啡`
**解釋：**自動記賬一筆咖啡類目的賬單，金額為26.5元。

你也可以使用佔位符的特性來實現輸入金額和分類：

![](_media/190/08.png ':size=30%')

**示例：**`qianji://publicapi/addbill?&type=0&catename=咖啡&money=[$decimal|請輸入金額]`
**解釋：**自動記賬一筆咖啡，金額為使用者輸入。



### ✨任務模板

透過上述的佔位符機制和新增任務 API。

你可以實現使用一個商品，只需要任務名稱和選擇清單，即可自動建立設定好獎勵的任務。

**示例：**`lifeup://api/add_task?todo=[$text|輸入任務名稱]&notes=這是任務獎勵模板建立的任務，你可以修改引數實現自己的模板&coin=10&coin_var=10&exp=2048&skills=1&skills=4&category=[$task_category]`

**解釋：**自動建立一個任務，名稱為使用者輸入，清單需要使用者選擇。自動新增備註，隨機金幣獎勵10-20，經驗值為2048點經驗值，選中的屬性id為1、4（一般是力量和耐力）。



### ✨Tasker 自動化：每天起床第一次解鎖手機，自動打卡「起床」任務

Tasker 是一款安卓端的自動化工具，它擁有著極高的許可權，可以實現各自事件監聽和程式設計邏輯。

我們在櫥窗和 API 文件中分享了一個簡單的示例：『每天起床第一次解鎖手機，自動打卡「起床」任務』。

當你已經安裝了 Tasker 後，在櫥窗進貨並使用該商品的話，可以自動匯入該配置和新建一個「起床」任務。


Tasker 還能實現諸如以下的效果：
- 刷 NFC 卡（背完單詞刷 NFC 打卡）
- 判斷連線到了家裏 WIFI（判斷到家提示個激勵語）
- 判斷 GPS 定位到了某地（到達新地點解鎖成就）等等。

如果想在 Tasker 中觸發「人升」API 的話，選擇操作類別-程式-快捷方式。在快捷方式一欄輸入 `lifeup://` 開頭的連結即可。



## 🚧API 支援

以上就是我們列舉的一些從簡到高階的 API 用法。

**目前「人升」支援以下 API：**

1. 彈出訊息（各種樣式）
2. 獎勵經驗值、金幣、商品
3. 懲罰經驗值、金幣、商品
4. 新增任務
5. 完成任務
6. 商店設定（ATM利率等）
7. 跳轉頁面
8. 新增商品
9. 調整商品（價格、庫存、名稱等）
10. 新增番茄計時記錄
11. 解鎖成就條件
12. 自定義分支彈窗
13. 調整開箱效果設定（數量、機率和增加物品）

以及支援「變數佔位符」和「結束回撥」等特性。

具體可以檢視 API 文件。



**本文僅做拋磚引玉，歡迎貢獻、設計和分享使用了 API 機制的特殊商品。**

如果你有餘力的話，也可以嘗試開發聯動網頁應用或安卓應用。

比如上述的獎勵模板功能，其實你可以開發一個很簡單的網頁，用來實現自己的任務模板列表。



未來，我們也會持續擴充 API，以及會考慮推出安卓SDK（甚至支援查詢任務列表、商品列表等）。以便更多應用能與人升聯動。


---

以前就是 v1.90.0 的第一期特性介紹，後續會再寫一下 v1.90.0 的更多功能特性和完整更新日誌，歡迎關注~

還沒有關注公眾號？

關注一波小透明吧.jpg

後續更新介紹等都會在公眾號釋出。

