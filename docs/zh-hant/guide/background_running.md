# 後臺保活

## 為什麼需要設定允許後臺執行？

部分手機廠商爲了省電或效能指標，會對除白名單（如 QQ、微信、支付寶）外的大多數應用實施嚴格後臺限制，導致部分依賴後臺的功能無法正常執行（例如切到後臺後番茄鐘被系統終止）。

**這類限制會顯著增加開發者的適配成本，也會提高使用者的配置成本。**

一般會導致出現以下現象：

- 切換到其他應用或鎖屏後，**番茄鍾、倒計時結束後不提醒或被暫停了**（前者是系統凍結了應用執行；後者是系統直接殺死了應用程序）。
- 後臺接收不到事項的通知提醒。
- 桌面小部件不會自動重新整理，或者有任務卻顯示「已經完成全部任務」。

<br/>

**這些設定是否會影響耗電量？**

理論上會有些許影響，但《人升》後臺只會執行必要的邏輯。

根據[開發工效](introduction/ergonomics.md)中的資料，後臺執行 24 小時的耗電量約為 30 mAh，佔比不到 1%。

<br/>

## 如何設定後臺執行

### 通用設定

> 以下步驟不一定要全部執行，但每完成一步，都可能提升《人升》後臺執行優先順序，幫助相關功能更穩定。

**Android 系統**

1. 進入《人升》，點選側邊欄-「設定」-「相容性問題」，點選「跳轉電池最佳化設定」，在該頁面找到《人升》並設定「不最佳化」。
   - 部分手機可能會跳轉後找不到《人升》，可忽略該配置。

2. 如果你希望收到通知，請確保授予《人升》通知許可權。

3. 在《人升》的「設定」-「事項」中，開啟「快速建立常駐通知」（可選）。

<br/>

**廠商自定義（手機管家）**

1. 在系統的多工管理介面，鎖定應用。
2. 在系統中查詢應用後臺管理（或電源最佳化、手機管家），將《人升》設定為「允許後臺執行（後臺不限制）」和「允許自啟動」。
3. 使用《人升》相關功能期間，**儘量避免開啟超級省電、嚴格免打擾等模式**，或將《人升》加入白名單。

<br/>

### 各個裝置設定方式

**或者直接參考飛書整理的各種裝置的設定方式：**

> 因為我們實在缺少相關手機和測試驗證的時間，直接外鏈下飛書的設定文件。
> 飛書也不在大多數廠商的後臺白名單中，同樣需要手動設定後臺許可權才能穩定接收通知。

[安卓裝置收不到新訊息通知怎麼辦？ (feishu.cn)](https://www.feishu.cn/hc/zh-CN/articles/360025451293)

1. [華為手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-RNpJyL)

2. [OPPO 手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-rqfhmK)

3. [Vivo 手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-xi6S8F)

4. [小米手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-uoxEk6)

5. [錘子手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-ylGl04)

6. [魅族手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-5zC9BG)

7. [三星手機](https://www.feishu.cn/hc/zh-CN/articles/360025451293#lineguid-e1tk3a)

除了文中提到的配置外，各廠商系統也可能持續增加新的省電策略。

開啟這類策略後，也可能影響《人升》相關功能的正常使用。



**設定後仍不生效？**

根據我們針對各個廠商的實測和使用者的反饋：

**在正確配置上述選項後，《人升》能在所有主流裝置上正常使用所有功能。**

但由於手機系統持續更新，相關配置項可能會隨版本變化而調整。

1. **請重新按照上述步驟查漏補缺**
   - 手機管家類的限制並非傳統的應用許可權，可能配置項會分散在不同的系統設定頁面裡。
   - 嘗試操作那些可選的步驟，比如開啟《人升》的常駐通知，檢視是否會有所幫助。
   - 手動在手機查詢可能會影響電池最佳化的選項。
   - 如果你只關注提醒，可以嘗試切換至「日曆提醒」方式。

2. 在 QQ 群或 QQ 頻道諮詢使用同品牌裝置的使用者，並清晰說明你的系統版本。

3. 也可以諮詢手機廠商客服或系統工程師，確認如何讓指定應用保持後臺執行。

---



以下是我們基於有限裝置整理的操作方式，可能隨系統更新而變化：

### 華為/榮耀

1. 開啟「設定」。
2. 搜尋「應用啟動管理」並點選。
3. 找到《人升》，設定為手動管理並允許自啟動。



**操作截圖如下：**

![](_media/background_running/emui_01.jpg ':size=50%')

![](_media/background_running/emui_02.jpg ':size=50%')

![](_media/background_running/emui_03.jpg ':size=50%')


### 魅族

1. 開啟「手機管家」應用。
2. 點選「許可權管理」。
3. 點選「後臺管理」。
4. 找到《人升》，選擇「允許後臺執行」。
5. （可選）多工介面中，長按鎖定《人升》。



**操作截圖如下：**


![](_media/background_running/flyme_01.jpg ':size=50%')

![](_media/background_running/flyme_02.jpg ':size=50%')

![](_media/background_running/flyme_03.jpg ':size=50%')
